{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:14.138Z",
  "checksum": "e02de8130c20eec6",
  "file": "backend/api/external/v1/integrations.py",
  "functions": [
    {
      "id": "backend/api/external/v1/integrations.py:validate_callback_url:170",
      "name": "validate_callback_url",
      "startLine": 170,
      "endLine": 192,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "urlparse",
          "resolved": false,
          "confidence": 0,
          "line": 175
        },
        {
          "target": "callback_url",
          "resolved": false,
          "confidence": 0,
          "line": 175
        },
        {
          "target": "urlparse",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "allowed",
          "resolved": false,
          "confidence": 0,
          "line": 186
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/external/v1/integrations.py:_get_oauth_handler_for_external:195",
      "name": "_get_oauth_handler_for_external",
      "startLine": 195,
      "endLine": 250,
      "isEntryPoint": false,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "load_all_blocks",
          "resolved": true,
          "confidence": 0.8,
          "line": 203,
          "resolvedId": "backend/blocks/__init__.py:load_all_blocks:20"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 205,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 208
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 214,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 214,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "getenv",
          "resolved": false,
          "confidence": 0,
          "line": 220
        },
        {
          "target": "getenv",
          "resolved": false,
          "confidence": 0,
          "line": 225
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 230
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 231
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 236,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 237
        },
        {
          "target": "handler_class",
          "resolved": false,
          "confidence": 0,
          "line": 246
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "os",
          "operation": "read",
          "line": 220,
          "fields": []
        },
        {
          "table": "os",
          "operation": "read",
          "line": 225,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/api/external/v1/integrations.py:list_providers:257",
      "name": "list_providers",
      "startLine": 257,
      "endLine": 311,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 258
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 259,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "load_all_blocks",
          "resolved": true,
          "confidence": 0.8,
          "line": 272,
          "resolvedId": "backend/blocks/__init__.py:load_all_blocks:20"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 274,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "get_all_provider_names",
          "resolved": true,
          "confidence": 0.4,
          "line": 279,
          "resolvedId": "backend/api/features/integrations/models.py:get_all_provider_names:14"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 281,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "name",
          "resolved": true,
          "confidence": 0.4,
          "line": 281,
          "resolvedId": "backend/api/features/chat/tools/agent_output.py:name:105"
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 283
        },
        {
          "target": "handler_class",
          "resolved": false,
          "confidence": 0,
          "line": 283
        },
        {
          "target": "get_provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 287,
          "resolvedId": "backend/sdk/registry.py:get_provider:143"
        },
        {
          "target": "name",
          "resolved": true,
          "confidence": 0.4,
          "line": 287,
          "resolvedId": "backend/api/features/chat/tools/agent_output.py:name:105"
        },
        {
          "target": "append",
          "resolved": false,
          "confidence": 0,
          "line": 300
        },
        {
          "target": "ProviderInfo",
          "resolved": false,
          "confidence": 0,
          "line": 301
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/external/v1/integrations.py:initiate_oauth:319",
      "name": "initiate_oauth",
      "startLine": 319,
      "endLine": 390,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 322
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 323,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "validate_callback_url",
          "resolved": true,
          "confidence": 0.95,
          "line": 337,
          "resolvedId": "backend/api/external/v1/integrations.py:validate_callback_url:170"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 338
        },
        {
          "target": "ProviderName",
          "resolved": false,
          "confidence": 0,
          "line": 348
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 348,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 352
        },
        {
          "target": "_get_oauth_handler_for_external",
          "resolved": true,
          "confidence": 0.95,
          "line": 359,
          "resolvedId": "backend/api/external/v1/integrations.py:_get_oauth_handler_for_external:195"
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 360
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 360,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 360
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 366
        },
        {
          "target": "auth",
          "resolved": false,
          "confidence": 0,
          "line": 366
        },
        {
          "target": "store_state_token",
          "resolved": true,
          "confidence": 0.8,
          "line": 367,
          "resolvedId": "backend/integrations/credentials_store.py:store_state_token:446"
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 369
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 369,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 369
        },
        {
          "target": "get_login_url",
          "resolved": true,
          "confidence": 0.4,
          "line": 377,
          "resolvedId": "backend/integrations/oauth/base.py:get_login_url:26"
        },
        {
          "target": "state_token",
          "resolved": false,
          "confidence": 0,
          "line": 378
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "timestamp",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "now",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "timedelta",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "OAuthInitiateResponse",
          "resolved": false,
          "confidence": 0,
          "line": 386
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/external/v1/integrations.py:complete_oauth:398",
      "name": "complete_oauth",
      "startLine": 398,
      "endLine": 473,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 401
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 402,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "verify_state_token",
          "resolved": true,
          "confidence": 0.8,
          "line": 413,
          "resolvedId": "backend/integrations/credentials_store.py:verify_state_token:500"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 414,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 418,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 419
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 426
        },
        {
          "target": "_get_oauth_handler_for_external",
          "resolved": true,
          "confidence": 0.95,
          "line": 432,
          "resolvedId": "backend/api/external/v1/integrations.py:_get_oauth_handler_for_external:195"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 432,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "handle_default_scopes",
          "resolved": true,
          "confidence": 0.8,
          "line": 436,
          "resolvedId": "backend/integrations/oauth/base.py:handle_default_scopes:80"
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 436
        },
        {
          "target": "exchange_code_for_tokens",
          "resolved": true,
          "confidence": 0.4,
          "line": 438,
          "resolvedId": "backend/integrations/oauth/base.py:exchange_code_for_tokens:35"
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 439
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 443
        },
        {
          "target": "split",
          "resolved": false,
          "confidence": 0,
          "line": 444
        },
        {
          "target": "issubset",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "set",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "set",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 448,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 454,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 455
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 457
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 457
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 461,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "credentials",
          "resolved": false,
          "confidence": 0,
          "line": 461
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 463,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "OAuthCompleteResponse",
          "resolved": false,
          "confidence": 0,
          "line": 465
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "credentials",
          "operation": "write",
          "line": 461,
          "fields": [
            "user_id"
          ]
        }
      ]
    },
    {
      "id": "backend/api/external/v1/integrations.py:list_credentials:477",
      "name": "list_credentials",
      "startLine": 477,
      "endLine": 499,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 478
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 479,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_all_creds",
          "resolved": true,
          "confidence": 0.8,
          "line": 487,
          "resolvedId": "backend/integrations/credentials_store.py:get_all_creds:307"
        },
        {
          "target": "CredentialSummary",
          "resolved": false,
          "confidence": 0,
          "line": 489
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 495
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 495
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 496
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 496
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/external/v1/integrations.py:list_credentials_by_provider:505",
      "name": "list_credentials_by_provider",
      "startLine": 505,
      "endLine": 528,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 507
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 508,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_creds_by_provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 514,
          "resolvedId": "backend/integrations/credentials_store.py:get_creds_by_provider:377"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 515,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "CredentialSummary",
          "resolved": false,
          "confidence": 0,
          "line": 518
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 523
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 523
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 524
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 524
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 525
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 525
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/external/v1/integrations.py:create_credential:537",
      "name": "create_credential",
      "startLine": 537,
      "endLine": 614,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "Body",
          "resolved": false,
          "confidence": 0,
          "line": 543
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 544
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 545,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_all_provider_names",
          "resolved": true,
          "confidence": 0.4,
          "line": 559,
          "resolvedId": "backend/api/features/integrations/models.py:get_all_provider_names:14"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 561
        },
        {
          "target": "APIKeyCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 569
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 571
        },
        {
          "target": "UserPasswordCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 576
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 578
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 579
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 584
        },
        {
          "target": "v",
          "resolved": false,
          "confidence": 0,
          "line": 584
        },
        {
          "target": "items",
          "resolved": true,
          "confidence": 0.4,
          "line": 584,
          "resolvedId": "backend/integrations/oauth/__init__.py:items:123"
        },
        {
          "target": "HostScopedCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 585
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 592
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 599,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "credentials",
          "resolved": false,
          "confidence": 0,
          "line": 599
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 601,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 602
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 604
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 604
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 607,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "CreateCredentialResponse",
          "resolved": false,
          "confidence": 0,
          "line": 609
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "credentials",
          "operation": "write",
          "line": 599,
          "fields": [
            "user_id"
          ]
        }
      ]
    },
    {
      "id": "backend/api/external/v1/integrations.py:delete_credential:628",
      "name": "delete_credential",
      "startLine": 628,
      "endLine": 655,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 631
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 632,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_creds_by_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 642,
          "resolvedId": "backend/integrations/credentials_store.py:get_creds_by_id:371"
        },
        {
          "target": "cred_id",
          "resolved": false,
          "confidence": 0,
          "line": 642
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 644
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 648
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 653,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        },
        {
          "target": "cred_id",
          "resolved": false,
          "confidence": 0,
          "line": 653
        },
        {
          "target": "DeleteCredentialResponse",
          "resolved": false,
          "confidence": 0,
          "line": 655
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "auth",
          "operation": "delete",
          "line": 653,
          "fields": [
            "user_id"
          ]
        }
      ]
    },
    {
      "id": "backend/api/external/v1/integrations.py:__module__:1",
      "name": "__module__",
      "startLine": 1,
      "endLine": 656,
      "isEntryPoint": false,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "getLogger",
          "resolved": false,
          "confidence": 0,
          "line": 38
        },
        {
          "target": "Settings",
          "resolved": false,
          "confidence": 0,
          "line": 39
        },
        {
          "target": "IntegrationCredentialsManager",
          "resolved": false,
          "confidence": 0,
          "line": 40
        },
        {
          "target": "APIRouter",
          "resolved": false,
          "confidence": 0,
          "line": 42
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 51
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 54
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 57
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 66
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 67
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 68
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 76
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 77
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 83
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 85
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 86
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 87
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 88
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 89
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 114
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 124
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 126
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 135
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 136
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 144
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 146
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "urlparse",
          "resolved": false,
          "confidence": 0,
          "line": 175
        },
        {
          "target": "callback_url",
          "resolved": false,
          "confidence": 0,
          "line": 175
        },
        {
          "target": "urlparse",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "allowed",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "load_all_blocks",
          "resolved": true,
          "confidence": 0.8,
          "line": 203,
          "resolvedId": "backend/blocks/__init__.py:load_all_blocks:20"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 205,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 208
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 214,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 214,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "getenv",
          "resolved": false,
          "confidence": 0,
          "line": 220
        },
        {
          "target": "getenv",
          "resolved": false,
          "confidence": 0,
          "line": 225
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 230
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 231
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 236,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 237
        },
        {
          "target": "handler_class",
          "resolved": false,
          "confidence": 0,
          "line": 246
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 256,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 258
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 259,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "load_all_blocks",
          "resolved": true,
          "confidence": 0.8,
          "line": 272,
          "resolvedId": "backend/blocks/__init__.py:load_all_blocks:20"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 274,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "get_all_provider_names",
          "resolved": true,
          "confidence": 0.4,
          "line": 279,
          "resolvedId": "backend/api/features/integrations/models.py:get_all_provider_names:14"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 281,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "name",
          "resolved": true,
          "confidence": 0.4,
          "line": 281,
          "resolvedId": "backend/api/features/chat/tools/agent_output.py:name:105"
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 283
        },
        {
          "target": "handler_class",
          "resolved": false,
          "confidence": 0,
          "line": 283
        },
        {
          "target": "get_provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 287,
          "resolvedId": "backend/sdk/registry.py:get_provider:143"
        },
        {
          "target": "name",
          "resolved": true,
          "confidence": 0.4,
          "line": 287,
          "resolvedId": "backend/api/features/chat/tools/agent_output.py:name:105"
        },
        {
          "target": "append",
          "resolved": false,
          "confidence": 0,
          "line": 300
        },
        {
          "target": "ProviderInfo",
          "resolved": false,
          "confidence": 0,
          "line": 301
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 314,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 322
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 323,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "validate_callback_url",
          "resolved": true,
          "confidence": 0.95,
          "line": 337,
          "resolvedId": "backend/api/external/v1/integrations.py:validate_callback_url:170"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 338
        },
        {
          "target": "ProviderName",
          "resolved": false,
          "confidence": 0,
          "line": 348
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 348,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 352
        },
        {
          "target": "_get_oauth_handler_for_external",
          "resolved": true,
          "confidence": 0.95,
          "line": 359,
          "resolvedId": "backend/api/external/v1/integrations.py:_get_oauth_handler_for_external:195"
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 360
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 360,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 360
        },
        {
          "target": "getattr",
          "resolved": false,
          "confidence": 0,
          "line": 366
        },
        {
          "target": "auth",
          "resolved": false,
          "confidence": 0,
          "line": 366
        },
        {
          "target": "store_state_token",
          "resolved": true,
          "confidence": 0.8,
          "line": 367,
          "resolvedId": "backend/integrations/credentials_store.py:store_state_token:446"
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 369
        },
        {
          "target": "provider_name",
          "resolved": true,
          "confidence": 0.8,
          "line": 369,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider_name:89"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 369
        },
        {
          "target": "get_login_url",
          "resolved": true,
          "confidence": 0.4,
          "line": 377,
          "resolvedId": "backend/integrations/oauth/base.py:get_login_url:26"
        },
        {
          "target": "state_token",
          "resolved": false,
          "confidence": 0,
          "line": 378
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "timestamp",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "now",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "timedelta",
          "resolved": false,
          "confidence": 0,
          "line": 384
        },
        {
          "target": "OAuthInitiateResponse",
          "resolved": false,
          "confidence": 0,
          "line": 386
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 393,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 401
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 402,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "verify_state_token",
          "resolved": true,
          "confidence": 0.8,
          "line": 413,
          "resolvedId": "backend/integrations/credentials_store.py:verify_state_token:500"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 414,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 418,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 419
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 426
        },
        {
          "target": "_get_oauth_handler_for_external",
          "resolved": true,
          "confidence": 0.95,
          "line": 432,
          "resolvedId": "backend/api/external/v1/integrations.py:_get_oauth_handler_for_external:195"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 432,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "handle_default_scopes",
          "resolved": true,
          "confidence": 0.8,
          "line": 436,
          "resolvedId": "backend/integrations/oauth/base.py:handle_default_scopes:80"
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 436
        },
        {
          "target": "exchange_code_for_tokens",
          "resolved": true,
          "confidence": 0.4,
          "line": 438,
          "resolvedId": "backend/integrations/oauth/base.py:exchange_code_for_tokens:35"
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 439
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 443
        },
        {
          "target": "split",
          "resolved": false,
          "confidence": 0,
          "line": 444
        },
        {
          "target": "issubset",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "set",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "scopes",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "set",
          "resolved": false,
          "confidence": 0,
          "line": 447
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 448,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 454,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 455
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 457
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 457
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 461,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "credentials",
          "resolved": false,
          "confidence": 0,
          "line": 461
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 463,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "OAuthCompleteResponse",
          "resolved": false,
          "confidence": 0,
          "line": 465
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 476,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 478
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 479,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_all_creds",
          "resolved": true,
          "confidence": 0.8,
          "line": 487,
          "resolvedId": "backend/integrations/credentials_store.py:get_all_creds:307"
        },
        {
          "target": "CredentialSummary",
          "resolved": false,
          "confidence": 0,
          "line": 489
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 495
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 495
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 496
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 496
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 502,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 507
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 508,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_creds_by_provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 514,
          "resolvedId": "backend/integrations/credentials_store.py:get_creds_by_provider:377"
        },
        {
          "target": "provider",
          "resolved": true,
          "confidence": 0.8,
          "line": 515,
          "resolvedId": "backend/blocks/stagehand/blocks.py:provider:109"
        },
        {
          "target": "CredentialSummary",
          "resolved": false,
          "confidence": 0,
          "line": 518
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 523
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 523
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 524
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 524
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 525
        },
        {
          "target": "cred",
          "resolved": false,
          "confidence": 0,
          "line": 525
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 531,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "Body",
          "resolved": false,
          "confidence": 0,
          "line": 543
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 544
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 545,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_all_provider_names",
          "resolved": true,
          "confidence": 0.4,
          "line": 559,
          "resolvedId": "backend/api/features/integrations/models.py:get_all_provider_names:14"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 561
        },
        {
          "target": "APIKeyCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 569
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 571
        },
        {
          "target": "UserPasswordCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 576
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 578
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 579
        },
        {
          "target": "SecretStr",
          "resolved": false,
          "confidence": 0,
          "line": 584
        },
        {
          "target": "v",
          "resolved": false,
          "confidence": 0,
          "line": 584
        },
        {
          "target": "items",
          "resolved": true,
          "confidence": 0.4,
          "line": 584,
          "resolvedId": "backend/integrations/oauth/__init__.py:items:123"
        },
        {
          "target": "HostScopedCredentials",
          "resolved": false,
          "confidence": 0,
          "line": 585
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 592
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 599,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "credentials",
          "resolved": false,
          "confidence": 0,
          "line": 599
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 601,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 602
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 604
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 604
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 607,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "CreateCredentialResponse",
          "resolved": false,
          "confidence": 0,
          "line": 609
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 620
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 621
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 624,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        },
        {
          "target": "Security",
          "resolved": false,
          "confidence": 0,
          "line": 631
        },
        {
          "target": "require_permission",
          "resolved": true,
          "confidence": 0.8,
          "line": 632,
          "resolvedId": "backend/api/external/middleware.py:require_permission:91"
        },
        {
          "target": "get_creds_by_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 642,
          "resolvedId": "backend/integrations/credentials_store.py:get_creds_by_id:371"
        },
        {
          "target": "cred_id",
          "resolved": false,
          "confidence": 0,
          "line": 642
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 644
        },
        {
          "target": "HTTPException",
          "resolved": false,
          "confidence": 0,
          "line": 648
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 653,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        },
        {
          "target": "cred_id",
          "resolved": false,
          "confidence": 0,
          "line": 653
        },
        {
          "target": "DeleteCredentialResponse",
          "resolved": false,
          "confidence": 0,
          "line": 655
        },
        {
          "target": "getLogger",
          "resolved": false,
          "confidence": 0,
          "line": 38
        },
        {
          "target": "Settings",
          "resolved": false,
          "confidence": 0,
          "line": 39
        },
        {
          "target": "IntegrationCredentialsManager",
          "resolved": false,
          "confidence": 0,
          "line": 40
        },
        {
          "target": "APIRouter",
          "resolved": false,
          "confidence": 0,
          "line": 42
        },
        {
          "target": "Field",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 256,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 314,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 393,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 476,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 502,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "post",
          "resolved": true,
          "confidence": 0.8,
          "line": 531,
          "resolvedId": "backend/util/request.py:post:563"
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 624,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "integrations_router",
          "operation": "delete",
          "line": 624,
          "fields": []
        },
        {
          "table": "logging",
          "operation": "read",
          "line": 38,
          "fields": []
        },
        {
          "table": "os",
          "operation": "read",
          "line": 220,
          "fields": []
        },
        {
          "table": "os",
          "operation": "read",
          "line": 225,
          "fields": []
        },
        {
          "table": "credentials",
          "operation": "write",
          "line": 461,
          "fields": [
            "user_id"
          ]
        },
        {
          "table": "credentials",
          "operation": "read",
          "line": 476,
          "fields": []
        },
        {
          "table": "credentials",
          "operation": "write",
          "line": 599,
          "fields": [
            "user_id"
          ]
        },
        {
          "table": "auth",
          "operation": "delete",
          "line": 653,
          "fields": [
            "user_id"
          ]
        }
      ]
    }
  ]
}
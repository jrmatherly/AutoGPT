{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:14.143Z",
  "checksum": "fc6a4367a55e2f5b",
  "file": "backend/util/virus_scanner_test.py",
  "functions": [
    {
      "id": "backend/util/virus_scanner_test.py:scanner_settings:18",
      "name": "scanner_settings",
      "startLine": 18,
      "endLine": 25,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 19
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:scanner:28",
      "name": "scanner",
      "startLine": 28,
      "endLine": 29,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 29
        },
        {
          "target": "scanner_settings",
          "resolved": true,
          "confidence": 0.95,
          "line": 29,
          "resolvedId": "backend/util/virus_scanner_test.py:scanner_settings:18"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:disabled_scanner:32",
      "name": "disabled_scanner",
      "startLine": 32,
      "endLine": 34,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 33
        },
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 34
        },
        {
          "target": "settings",
          "resolved": false,
          "confidence": 0,
          "line": 34
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scanner_initialization:36",
      "name": "test_scanner_initialization",
      "startLine": 36,
      "endLine": 40,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 37
        },
        {
          "target": "scanner_settings",
          "resolved": true,
          "confidence": 0.95,
          "line": 37,
          "resolvedId": "backend/util/virus_scanner_test.py:scanner_settings:18"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_disabled_returns_clean:43",
      "name": "test_scan_disabled_returns_clean",
      "startLine": 43,
      "endLine": 50,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 45,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 45
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 49
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 49
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_file_too_large:53",
      "name": "test_scan_file_too_large",
      "startLine": 53,
      "endLine": 61,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 58,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "large_content",
          "resolved": false,
          "confidence": 0,
          "line": 58
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 60
        },
        {
          "target": "large_content",
          "resolved": false,
          "confidence": 0,
          "line": 60
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_file_too_large_both_configurations:64",
      "name": "test_scan_file_too_large_both_configurations",
      "startLine": 64,
      "endLine": 86,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 69
        },
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 72
        },
        {
          "target": "settings_clean",
          "resolved": false,
          "confidence": 0,
          "line": 72
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 73,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "large_content",
          "resolved": false,
          "confidence": 0,
          "line": 74
        },
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 79
        },
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 82
        },
        {
          "target": "settings_dirty",
          "resolved": false,
          "confidence": 0,
          "line": 82
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 83,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "large_content",
          "resolved": false,
          "confidence": 0,
          "line": 84
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_clean_file:91",
      "name": "test_scan_clean_file",
      "startLine": 91,
      "endLine": 109,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 96
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 97
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 98
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 104,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 104
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 108
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 108
        },
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 93,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:mock_instream:92",
      "name": "mock_instream",
      "startLine": 92,
      "endLine": 94,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 93,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_infected_file:112",
      "name": "test_scan_infected_file",
      "startLine": 112,
      "endLine": 130,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 117
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 118
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 119
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 125,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 114,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:mock_instream:113",
      "name": "mock_instream",
      "startLine": 113,
      "endLine": 115,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 114,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_clamav_unavailable_fail_safe:133",
      "name": "test_scan_clamav_unavailable_fail_safe",
      "startLine": 133,
      "endLine": 143,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 134
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 135
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 142
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 143,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 143
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_error_fail_safe:146",
      "name": "test_scan_error_fail_safe",
      "startLine": 146,
      "endLine": 157,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 147
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "Exception",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 156
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 157,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 157
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_get_virus_scanner_singleton:161",
      "name": "test_get_virus_scanner_singleton",
      "startLine": 161,
      "endLine": 166,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "get_virus_scanner",
          "resolved": true,
          "confidence": 0.8,
          "line": 162,
          "resolvedId": "backend/util/virus_scanner.py:get_virus_scanner:177"
        },
        {
          "target": "get_virus_scanner",
          "resolved": true,
          "confidence": 0.8,
          "line": 163,
          "resolvedId": "backend/util/virus_scanner.py:get_virus_scanner:177"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_result_model:170",
      "name": "test_scan_result_model",
      "startLine": 170,
      "endLine": 179,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 172
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_concurrent_scans:182",
      "name": "test_concurrent_scans",
      "startLine": 182,
      "endLine": 207,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 188
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 189
        },
        {
          "target": "gather",
          "resolved": false,
          "confidence": 0,
          "line": 198
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 199,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content1",
          "resolved": false,
          "confidence": 0,
          "line": 199
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.8,
          "line": 200,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content2",
          "resolved": false,
          "confidence": 0,
          "line": 200
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 203
        },
        {
          "target": "results",
          "resolved": false,
          "confidence": 0,
          "line": 203
        },
        {
          "target": "all",
          "resolved": false,
          "confidence": 0,
          "line": 204
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 205
        },
        {
          "target": "content1",
          "resolved": false,
          "confidence": 0,
          "line": 205
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 206
        },
        {
          "target": "content2",
          "resolved": false,
          "confidence": 0,
          "line": 206
        },
        {
          "target": "all",
          "resolved": false,
          "confidence": 0,
          "line": 207
        },
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 184,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:mock_instream:183",
      "name": "mock_instream",
      "startLine": 183,
      "endLine": 185,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "sleep",
          "resolved": true,
          "confidence": 0.8,
          "line": 184,
          "resolvedId": "load-tests/orchestrator/orchestrator.js:sleep:171"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_content_safe_clean:214",
      "name": "test_scan_content_safe_clean",
      "startLine": 214,
      "endLine": 225,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": true,
          "confidence": 0.8,
          "line": 216,
          "resolvedId": "backend/util/request.py:patch:578"
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 217
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 218
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 219
        },
        {
          "target": "scan_content_safe",
          "resolved": true,
          "confidence": 0.8,
          "line": 225,
          "resolvedId": "backend/util/virus_scanner.py:scan_content_safe:191"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_content_safe_infected:228",
      "name": "test_scan_content_safe_infected",
      "startLine": 228,
      "endLine": 241,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": true,
          "confidence": 0.8,
          "line": 230,
          "resolvedId": "backend/util/request.py:patch:578"
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 231
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 232
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 233
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 238
        },
        {
          "target": "scan_content_safe",
          "resolved": true,
          "confidence": 0.8,
          "line": 239,
          "resolvedId": "backend/util/virus_scanner.py:scan_content_safe:191"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner_test.py:test_scan_content_safe_scan_error:244",
      "name": "test_scan_content_safe_scan_error",
      "startLine": 244,
      "endLine": 253,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": true,
          "confidence": 0.8,
          "line": 246,
          "resolvedId": "backend/util/request.py:patch:578"
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 247
        },
        {
          "target": "AsyncMock",
          "resolved": false,
          "confidence": 0,
          "line": 248
        },
        {
          "target": "Exception",
          "resolved": false,
          "confidence": 0,
          "line": 249
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 252
        },
        {
          "target": "scan_content_safe",
          "resolved": true,
          "confidence": 0.8,
          "line": 253,
          "resolvedId": "backend/util/virus_scanner.py:scan_content_safe:191"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    }
  ]
}
{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:14.123Z",
  "checksum": "4a6420fd41ed9515",
  "file": "backend/data/credit_integration_test.py",
  "functions": [
    {
      "id": "backend/data/credit_integration_test.py:cleanup_test_user:23",
      "name": "cleanup_test_user",
      "startLine": 23,
      "endLine": 52,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 27
        },
        {
          "target": "uuid4",
          "resolved": false,
          "confidence": 0,
          "line": 27
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 31,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 31
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 35
        },
        {
          "target": "delete_many",
          "resolved": false,
          "confidence": 0,
          "line": 46
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 46
        },
        {
          "target": "delete_many",
          "resolved": false,
          "confidence": 0,
          "line": 47
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 47
        },
        {
          "target": "update",
          "resolved": true,
          "confidence": 0.8,
          "line": 49,
          "resolvedId": "backend/integrations/creds_manager.py:update:162"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 49
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 50
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 52,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 52
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "write",
          "line": 31,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "write",
          "line": 49,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "delete",
          "line": 52,
          "fields": [
            "id",
            "user_id"
          ]
        }
      ]
    },
    {
      "id": "backend/data/credit_integration_test.py:test_credit_transaction_enum_casting_integration:56",
      "name": "test_credit_transaction_enum_casting_integration",
      "startLine": 56,
      "endLine": 99,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 64
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 76
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 79
        },
        {
          "target": "find_first",
          "resolved": false,
          "confidence": 0,
          "line": 88
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 88
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "read",
          "line": 88,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/data/credit_integration_test.py:test_auto_top_up_integration:103",
      "name": "test_auto_top_up_integration",
      "startLine": 103,
      "endLine": 168,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 114
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 115
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 118
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 121
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "AutoTopUpConfig",
          "resolved": false,
          "confidence": 0,
          "line": 130
        },
        {
          "target": "set_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 131
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 131
        },
        {
          "target": "config",
          "resolved": true,
          "confidence": 0.8,
          "line": 131,
          "resolvedId": "backend/util/cloud_storage_test.py:config:16"
        },
        {
          "target": "get_credits",
          "resolved": false,
          "confidence": 0,
          "line": 134
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 134
        },
        {
          "target": "UsageTransactionMetadata",
          "resolved": false,
          "confidence": 0,
          "line": 140
        },
        {
          "target": "spend_credits",
          "resolved": true,
          "confidence": 0.8,
          "line": 141,
          "resolvedId": "backend/data/credit_test.py:spend_credits:42"
        },
        {
          "target": "find_many",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 150
        },
        {
          "target": "transactions",
          "resolved": false,
          "confidence": 0,
          "line": 150
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 162
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 162
        },
        {
          "target": "lower",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "lower",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "fail",
          "resolved": false,
          "confidence": 0,
          "line": 165
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "read",
          "line": 145,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/data/credit_integration_test.py:test_enable_transaction_enum_casting_integration:172",
      "name": "test_enable_transaction_enum_casting_integration",
      "startLine": 172,
      "endLine": 225,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 180
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 183
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 195
        },
        {
          "target": "_enable_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 203
        },
        {
          "target": "find_first",
          "resolved": false,
          "confidence": 0,
          "line": 213
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 213
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "read",
          "line": 213,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/data/credit_integration_test.py:test_auto_top_up_configuration_storage:229",
      "name": "test_auto_top_up_configuration_storage",
      "startLine": 229,
      "endLine": 277,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 240
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 241
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 242
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 245
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 248
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 252
        },
        {
          "target": "AutoTopUpConfig",
          "resolved": false,
          "confidence": 0,
          "line": 258
        },
        {
          "target": "set_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 259
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 259
        },
        {
          "target": "config",
          "resolved": true,
          "confidence": 0.8,
          "line": 259,
          "resolvedId": "backend/util/cloud_storage_test.py:config:16"
        },
        {
          "target": "get_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 262
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 262
        },
        {
          "target": "get_credits",
          "resolved": false,
          "confidence": 0,
          "line": 267
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 267
        },
        {
          "target": "find_many",
          "resolved": false,
          "confidence": 0,
          "line": 271
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 271
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 276
        },
        {
          "target": "transactions",
          "resolved": false,
          "confidence": 0,
          "line": 276
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "read",
          "line": 271,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/data/credit_integration_test.py:__module__:1",
      "name": "__module__",
      "startLine": 1,
      "endLine": 278,
      "isEntryPoint": false,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 27
        },
        {
          "target": "uuid4",
          "resolved": false,
          "confidence": 0,
          "line": 27
        },
        {
          "target": "create",
          "resolved": true,
          "confidence": 0.8,
          "line": 31,
          "resolvedId": "backend/integrations/creds_manager.py:create:68"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 31
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 35
        },
        {
          "target": "delete_many",
          "resolved": false,
          "confidence": 0,
          "line": 46
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 46
        },
        {
          "target": "delete_many",
          "resolved": false,
          "confidence": 0,
          "line": 47
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 47
        },
        {
          "target": "update",
          "resolved": true,
          "confidence": 0.8,
          "line": 49,
          "resolvedId": "backend/integrations/creds_manager.py:update:162"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 49
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 50
        },
        {
          "target": "delete",
          "resolved": true,
          "confidence": 0.4,
          "line": 52,
          "resolvedId": "backend/integrations/creds_manager.py:delete:166"
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 52
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 55
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 64
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 76
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 79
        },
        {
          "target": "find_first",
          "resolved": false,
          "confidence": 0,
          "line": 88
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 88
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 102
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 114
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 115
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 118
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 121
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "AutoTopUpConfig",
          "resolved": false,
          "confidence": 0,
          "line": 130
        },
        {
          "target": "set_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 131
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 131
        },
        {
          "target": "config",
          "resolved": true,
          "confidence": 0.8,
          "line": 131,
          "resolvedId": "backend/util/cloud_storage_test.py:config:16"
        },
        {
          "target": "get_credits",
          "resolved": false,
          "confidence": 0,
          "line": 134
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 134
        },
        {
          "target": "UsageTransactionMetadata",
          "resolved": false,
          "confidence": 0,
          "line": 140
        },
        {
          "target": "spend_credits",
          "resolved": true,
          "confidence": 0.8,
          "line": 141,
          "resolvedId": "backend/data/credit_test.py:spend_credits:42"
        },
        {
          "target": "find_many",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 150
        },
        {
          "target": "transactions",
          "resolved": false,
          "confidence": 0,
          "line": 150
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 162
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 162
        },
        {
          "target": "lower",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "lower",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 163
        },
        {
          "target": "fail",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 171
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 180
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 183
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 195
        },
        {
          "target": "_enable_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 203
        },
        {
          "target": "find_first",
          "resolved": false,
          "confidence": 0,
          "line": 213
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 213
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 228
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 240
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 241
        },
        {
          "target": "setattr",
          "resolved": false,
          "confidence": 0,
          "line": 242
        },
        {
          "target": "BetaUserCredit",
          "resolved": false,
          "confidence": 0,
          "line": 245
        },
        {
          "target": "_add_transaction",
          "resolved": false,
          "confidence": 0,
          "line": 248
        },
        {
          "target": "SafeJson",
          "resolved": false,
          "confidence": 0,
          "line": 252
        },
        {
          "target": "AutoTopUpConfig",
          "resolved": false,
          "confidence": 0,
          "line": 258
        },
        {
          "target": "set_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 259
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 259
        },
        {
          "target": "config",
          "resolved": true,
          "confidence": 0.8,
          "line": 259,
          "resolvedId": "backend/util/cloud_storage_test.py:config:16"
        },
        {
          "target": "get_auto_top_up",
          "resolved": false,
          "confidence": 0,
          "line": 262
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 262
        },
        {
          "target": "get_credits",
          "resolved": false,
          "confidence": 0,
          "line": 267
        },
        {
          "target": "user_id",
          "resolved": false,
          "confidence": 0,
          "line": 267
        },
        {
          "target": "find_many",
          "resolved": false,
          "confidence": 0,
          "line": 271
        },
        {
          "target": "prisma",
          "resolved": false,
          "confidence": 0,
          "line": 271
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 276
        },
        {
          "target": "transactions",
          "resolved": false,
          "confidence": 0,
          "line": 276
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 55
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 102
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 171
        },
        {
          "target": "asyncio",
          "resolved": false,
          "confidence": 0,
          "line": 228
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "prisma",
          "operation": "write",
          "line": 31,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "write",
          "line": 49,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "delete",
          "line": 52,
          "fields": [
            "id",
            "user_id"
          ]
        },
        {
          "table": "prisma",
          "operation": "read",
          "line": 88,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "read",
          "line": 145,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "read",
          "line": 213,
          "fields": []
        },
        {
          "table": "prisma",
          "operation": "read",
          "line": 271,
          "fields": []
        }
      ]
    }
  ]
}
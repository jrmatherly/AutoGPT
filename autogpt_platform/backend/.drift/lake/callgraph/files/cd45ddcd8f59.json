{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:14.216Z",
  "checksum": "99f997bc54ed5ceb",
  "file": "backend/util/virus_scanner.py",
  "functions": [
    {
      "id": "backend/util/virus_scanner.py:__init__:56",
      "name": "__init__",
      "startLine": 56,
      "endLine": 63,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "ClamdAsyncClient",
          "resolved": false,
          "confidence": 0,
          "line": 58
        },
        {
          "target": "Semaphore",
          "resolved": false,
          "confidence": 0,
          "line": 63
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:_parse_raw:70",
      "name": "_parse_raw",
      "startLine": 70,
      "endLine": 78,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "next",
          "resolved": false,
          "confidence": 0,
          "line": 77
        },
        {
          "target": "iter",
          "resolved": false,
          "confidence": 0,
          "line": 77
        },
        {
          "target": "values",
          "resolved": true,
          "confidence": 0.4,
          "line": 77,
          "resolvedId": "backend/integrations/oauth/__init__.py:values:112"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:_instream:80",
      "name": "_instream",
      "startLine": 80,
      "endLine": 91,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "instream",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "BytesIO",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "chunk",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "_parse_raw",
          "resolved": true,
          "confidence": 0.95,
          "line": 85,
          "resolvedId": "backend/util/virus_scanner.py:_parse_raw:70"
        },
        {
          "target": "raw",
          "resolved": false,
          "confidence": 0,
          "line": 85
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 87
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 89
        },
        {
          "target": "exc",
          "resolved": false,
          "confidence": 0,
          "line": 89
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 90
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:scan_file:97",
      "name": "scan_file",
      "startLine": 97,
      "endLine": 171,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 107,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 108
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 109
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 109
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 111
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 111
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 112,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 115
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 117
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 117
        },
        {
          "target": "ping",
          "resolved": false,
          "confidence": 0,
          "line": 122
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 123
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 126
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 126
        },
        {
          "target": "range",
          "resolved": false,
          "confidence": 0,
          "line": 127
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "debug",
          "resolved": true,
          "confidence": 0.8,
          "line": 131,
          "resolvedId": "backend/util/logging.py:debug:53"
        },
        {
          "target": "create_task",
          "resolved": true,
          "confidence": 0.8,
          "line": 136,
          "resolvedId": "backend/blocks/todoist/tasks.py:create_task:129"
        },
        {
          "target": "_instream",
          "resolved": true,
          "confidence": 0.95,
          "line": 136,
          "resolvedId": "backend/util/virus_scanner.py:_instream:80"
        },
        {
          "target": "range",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "chunk_size",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "as_completed",
          "resolved": false,
          "confidence": 0,
          "line": 139
        },
        {
          "target": "tasks",
          "resolved": false,
          "confidence": 0,
          "line": 139
        },
        {
          "target": "done",
          "resolved": false,
          "confidence": 0,
          "line": 143
        },
        {
          "target": "cancel",
          "resolved": false,
          "confidence": 0,
          "line": 144
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 152
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 155
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 155
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 158
        },
        {
          "target": "exc",
          "resolved": false,
          "confidence": 0,
          "line": 158
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 161,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 164,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 167
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 169
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 169
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 170
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 170
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:get_virus_scanner:177",
      "name": "get_virus_scanner",
      "startLine": 177,
      "endLine": 188,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 180
        },
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "_settings",
          "resolved": false,
          "confidence": 0,
          "line": 187
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:scan_content_safe:191",
      "name": "scan_content_safe",
      "startLine": 191,
      "endLine": 216,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.95,
          "line": 202,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 202
        },
        {
          "target": "get_virus_scanner",
          "resolved": true,
          "confidence": 0.95,
          "line": 202,
          "resolvedId": "backend/util/virus_scanner.py:get_virus_scanner:177"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 205,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "VirusDetectedError",
          "resolved": false,
          "confidence": 0,
          "line": 206
        },
        {
          "target": "threat_name",
          "resolved": false,
          "confidence": 0,
          "line": 207
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 210,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 215,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 215
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 215
        },
        {
          "target": "VirusScanError",
          "resolved": false,
          "confidence": 0,
          "line": 216
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 216
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 216
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/util/virus_scanner.py:__module__:1",
      "name": "__module__",
      "startLine": 1,
      "endLine": 217,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "catch_warnings",
          "resolved": false,
          "confidence": 0,
          "line": 9
        },
        {
          "target": "filterwarnings",
          "resolved": false,
          "confidence": 0,
          "line": 10
        },
        {
          "target": "getLogger",
          "resolved": false,
          "confidence": 0,
          "line": 20
        },
        {
          "target": "Settings",
          "resolved": false,
          "confidence": 0,
          "line": 21
        },
        {
          "target": "ClamdAsyncClient",
          "resolved": false,
          "confidence": 0,
          "line": 58
        },
        {
          "target": "Semaphore",
          "resolved": false,
          "confidence": 0,
          "line": 63
        },
        {
          "target": "next",
          "resolved": false,
          "confidence": 0,
          "line": 77
        },
        {
          "target": "iter",
          "resolved": false,
          "confidence": 0,
          "line": 77
        },
        {
          "target": "values",
          "resolved": true,
          "confidence": 0.4,
          "line": 77,
          "resolvedId": "backend/integrations/oauth/__init__.py:values:112"
        },
        {
          "target": "instream",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "BytesIO",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "chunk",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "_parse_raw",
          "resolved": true,
          "confidence": 0.95,
          "line": 85,
          "resolvedId": "backend/util/virus_scanner.py:_parse_raw:70"
        },
        {
          "target": "raw",
          "resolved": false,
          "confidence": 0,
          "line": 85
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 87
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 89
        },
        {
          "target": "exc",
          "resolved": false,
          "confidence": 0,
          "line": 89
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 90
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 107,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 108
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 109
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 109
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 111
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 111
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 112,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 113
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 115
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 117
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 117
        },
        {
          "target": "ping",
          "resolved": false,
          "confidence": 0,
          "line": 122
        },
        {
          "target": "RuntimeError",
          "resolved": false,
          "confidence": 0,
          "line": 123
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 125
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 126
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 126
        },
        {
          "target": "range",
          "resolved": false,
          "confidence": 0,
          "line": 127
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "debug",
          "resolved": true,
          "confidence": 0.8,
          "line": 131,
          "resolvedId": "backend/util/logging.py:debug:53"
        },
        {
          "target": "create_task",
          "resolved": true,
          "confidence": 0.8,
          "line": 136,
          "resolvedId": "backend/blocks/todoist/tasks.py:create_task:129"
        },
        {
          "target": "_instream",
          "resolved": true,
          "confidence": 0.95,
          "line": 136,
          "resolvedId": "backend/util/virus_scanner.py:_instream:80"
        },
        {
          "target": "range",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "chunk_size",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 137
        },
        {
          "target": "as_completed",
          "resolved": false,
          "confidence": 0,
          "line": 139
        },
        {
          "target": "tasks",
          "resolved": false,
          "confidence": 0,
          "line": 139
        },
        {
          "target": "done",
          "resolved": false,
          "confidence": 0,
          "line": 143
        },
        {
          "target": "cancel",
          "resolved": false,
          "confidence": 0,
          "line": 144
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 145
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 149
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 152
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 154
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 155
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 155
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 158
        },
        {
          "target": "exc",
          "resolved": false,
          "confidence": 0,
          "line": 158
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 161,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 164,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "VirusScanResult",
          "resolved": false,
          "confidence": 0,
          "line": 167
        },
        {
          "target": "len",
          "resolved": false,
          "confidence": 0,
          "line": 169
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 169
        },
        {
          "target": "int",
          "resolved": false,
          "confidence": 0,
          "line": 170
        },
        {
          "target": "monotonic",
          "resolved": false,
          "confidence": 0,
          "line": 170
        },
        {
          "target": "VirusScannerSettings",
          "resolved": false,
          "confidence": 0,
          "line": 180
        },
        {
          "target": "VirusScannerService",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "_settings",
          "resolved": false,
          "confidence": 0,
          "line": 187
        },
        {
          "target": "scan_file",
          "resolved": true,
          "confidence": 0.95,
          "line": 202,
          "resolvedId": "backend/util/virus_scanner.py:scan_file:97"
        },
        {
          "target": "content",
          "resolved": false,
          "confidence": 0,
          "line": 202
        },
        {
          "target": "get_virus_scanner",
          "resolved": true,
          "confidence": 0.95,
          "line": 202,
          "resolvedId": "backend/util/virus_scanner.py:get_virus_scanner:177"
        },
        {
          "target": "warning",
          "resolved": true,
          "confidence": 0.8,
          "line": 205,
          "resolvedId": "backend/util/logging.py:warning:45"
        },
        {
          "target": "VirusDetectedError",
          "resolved": false,
          "confidence": 0,
          "line": 206
        },
        {
          "target": "threat_name",
          "resolved": false,
          "confidence": 0,
          "line": 207
        },
        {
          "target": "info",
          "resolved": true,
          "confidence": 0.8,
          "line": 210,
          "resolvedId": "backend/util/logging.py:info:41"
        },
        {
          "target": "error",
          "resolved": true,
          "confidence": 0.8,
          "line": 215,
          "resolvedId": "backend/util/logging.py:error:49"
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 215
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 215
        },
        {
          "target": "VirusScanError",
          "resolved": false,
          "confidence": 0,
          "line": 216
        },
        {
          "target": "str",
          "resolved": false,
          "confidence": 0,
          "line": 216
        },
        {
          "target": "e",
          "resolved": false,
          "confidence": 0,
          "line": 216
        },
        {
          "target": "catch_warnings",
          "resolved": false,
          "confidence": 0,
          "line": 9
        },
        {
          "target": "filterwarnings",
          "resolved": false,
          "confidence": 0,
          "line": 10
        },
        {
          "target": "getLogger",
          "resolved": false,
          "confidence": 0,
          "line": 20
        },
        {
          "target": "Settings",
          "resolved": false,
          "confidence": 0,
          "line": 21
        }
      ],
      "calledBy": [],
      "dataAccess": []
    }
  ]
}
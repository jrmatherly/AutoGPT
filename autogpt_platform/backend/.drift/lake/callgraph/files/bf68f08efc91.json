{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:14.210Z",
  "checksum": "37885653df31e2db",
  "file": "backend/api/middleware/security_test.py",
  "functions": [
    {
      "id": "backend/api/middleware/security_test.py:app:10",
      "name": "app",
      "startLine": 10,
      "endLine": 43,
      "isEntryPoint": true,
      "isDataAccessor": true,
      "calls": [
        {
          "target": "FastAPI",
          "resolved": false,
          "confidence": 0,
          "line": 12
        },
        {
          "target": "add_middleware",
          "resolved": false,
          "confidence": 0,
          "line": 13
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 15,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 19,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 23,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 27,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 31,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 35,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 39,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        }
      ],
      "calledBy": [],
      "dataAccess": [
        {
          "table": "user",
          "operation": "read",
          "line": 15,
          "fields": []
        },
        {
          "table": "OAuth",
          "operation": "read",
          "line": 19,
          "fields": []
        }
      ]
    },
    {
      "id": "backend/api/middleware/security_test.py:client:47",
      "name": "client",
      "startLine": 47,
      "endLine": 49,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "TestClient",
          "resolved": false,
          "confidence": 0,
          "line": 49
        },
        {
          "target": "app",
          "resolved": true,
          "confidence": 0.95,
          "line": 49,
          "resolvedId": "backend/api/middleware/security_test.py:app:10"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/middleware/security_test.py:test_non_cacheable_endpoints_have_cache_control_headers:52",
      "name": "test_non_cacheable_endpoints_have_cache_control_headers",
      "startLine": 52,
      "endLine": 76,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 62,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "endpoint",
          "resolved": false,
          "confidence": 0,
          "line": 62
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/middleware/security_test.py:test_cacheable_endpoints_dont_have_cache_control_headers:79",
      "name": "test_cacheable_endpoints_dont_have_cache_control_headers",
      "startLine": 79,
      "endLine": 107,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 88,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "endpoint",
          "resolved": false,
          "confidence": 0,
          "line": 88
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 93,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 97,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        },
        {
          "target": "get",
          "resolved": true,
          "confidence": 0.4,
          "line": 100,
          "resolvedId": "backend/integrations/oauth/__init__.py:get:83"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/middleware/security_test.py:test_is_cacheable_path_detection:110",
      "name": "test_is_cacheable_path_detection",
      "startLine": 110,
      "endLine": 127,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "SecurityHeadersMiddleware",
          "resolved": false,
          "confidence": 0,
          "line": 112
        },
        {
          "target": "Starlette",
          "resolved": false,
          "confidence": 0,
          "line": 112
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 115,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 116,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 117,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 118,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 119,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 120,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 123,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 124,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 125,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 126,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 127,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "backend/api/middleware/security_test.py:test_path_prefix_matching:130",
      "name": "test_path_prefix_matching",
      "startLine": 130,
      "endLine": 143,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "SecurityHeadersMiddleware",
          "resolved": false,
          "confidence": 0,
          "line": 132
        },
        {
          "target": "Starlette",
          "resolved": false,
          "confidence": 0,
          "line": 132
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 135,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 136,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 137,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 138,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 141,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 142,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        },
        {
          "target": "is_cacheable_path",
          "resolved": true,
          "confidence": 0.8,
          "line": 143,
          "resolvedId": "backend/api/middleware/security.py:is_cacheable_path:61"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    }
  ]
}
{
  "version": "1.0.0",
  "generatedAt": "2026-01-29T07:19:21.048Z",
  "checksum": "ed098c25feb91455",
  "file": "autogpt_libs/auth/dependencies_test.py",
  "functions": [
    {
      "id": "autogpt_libs/auth/dependencies_test.py:app:26",
      "name": "app",
      "startLine": 26,
      "endLine": 42,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "FastAPI",
          "resolved": false,
          "confidence": 0,
          "line": 28
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 30
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 34
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 38
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:client:45",
      "name": "client",
      "startLine": 45,
      "endLine": 47,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "TestClient",
          "resolved": false,
          "confidence": 0,
          "line": 47
        },
        {
          "target": "app",
          "resolved": true,
          "confidence": 0.95,
          "line": 47,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:app:26"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_user_with_valid_jwt_payload:50",
      "name": "test_requires_user_with_valid_jwt_payload",
      "startLine": 50,
      "endLine": 61,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 55
        },
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 58,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 58
        },
        {
          "target": "isinstance",
          "resolved": false,
          "confidence": 0,
          "line": 59
        },
        {
          "target": "user",
          "resolved": false,
          "confidence": 0,
          "line": 59
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_user_with_admin_jwt_payload:64",
      "name": "test_requires_user_with_admin_jwt_payload",
      "startLine": 64,
      "endLine": 77,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 72
        },
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 75,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 75
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_user_missing_sub:80",
      "name": "test_requires_user_missing_sub",
      "startLine": 80,
      "endLine": 87,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 84
        },
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 85,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 85
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_user_empty_sub:90",
      "name": "test_requires_user_empty_sub",
      "startLine": 90,
      "endLine": 96,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 94
        },
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 95,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 95
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_admin_user_with_admin:99",
      "name": "test_requires_admin_user_with_admin",
      "startLine": 99,
      "endLine": 112,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 107
        },
        {
          "target": "requires_admin_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 110,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_admin_user:65"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 110
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_admin_user_with_regular_user:115",
      "name": "test_requires_admin_user_with_regular_user",
      "startLine": 115,
      "endLine": 122,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 119
        },
        {
          "target": "requires_admin_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 120,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_admin_user:65"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 120
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_requires_admin_user_missing_role:125",
      "name": "test_requires_admin_user_missing_role",
      "startLine": 125,
      "endLine": 130,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 129
        },
        {
          "target": "requires_admin_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 130,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_admin_user:65"
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 130
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_get_user_id_with_valid_payload:133",
      "name": "test_get_user_id_with_valid_payload",
      "startLine": 133,
      "endLine": 143,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 135
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 139
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 142,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 142
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 142
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_get_user_id_missing_sub:146",
      "name": "test_get_user_id_missing_sub",
      "startLine": 146,
      "endLine": 155,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 148
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 152
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 153,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 153
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 153
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_get_user_id_none_sub:158",
      "name": "test_get_user_id_none_sub",
      "startLine": 158,
      "endLine": 166,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 160
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 164
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 165,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 165
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 165
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:create_token:175",
      "name": "create_token",
      "startLine": 175,
      "endLine": 188,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "dict",
          "resolved": false,
          "confidence": 0,
          "line": 179
        },
        {
          "target": "encode",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "payload",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "secret",
          "resolved": false,
          "confidence": 0,
          "line": 186
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:_create_token:185",
      "name": "_create_token",
      "startLine": 185,
      "endLine": 186,
      "isEntryPoint": false,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "encode",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "payload",
          "resolved": false,
          "confidence": 0,
          "line": 186
        },
        {
          "target": "secret",
          "resolved": false,
          "confidence": 0,
          "line": 186
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_endpoint_auth_enabled_no_token:191",
      "name": "test_endpoint_auth_enabled_no_token",
      "startLine": 191,
      "endLine": 203,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "FastAPI",
          "resolved": false,
          "confidence": 0,
          "line": 193
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 195
        },
        {
          "target": "TestClient",
          "resolved": false,
          "confidence": 0,
          "line": 199
        },
        {
          "target": "app",
          "resolved": true,
          "confidence": 0.95,
          "line": 199,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:app:26"
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 202
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_endpoint_with_valid_token:206",
      "name": "test_endpoint_with_valid_token",
      "startLine": 206,
      "endLine": 223,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "FastAPI",
          "resolved": false,
          "confidence": 0,
          "line": 208
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 210
        },
        {
          "target": "TestClient",
          "resolved": false,
          "confidence": 0,
          "line": 214
        },
        {
          "target": "app",
          "resolved": true,
          "confidence": 0.95,
          "line": 214,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:app:26"
        },
        {
          "target": "create_token",
          "resolved": true,
          "confidence": 0.95,
          "line": 216,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:create_token:175"
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 221
        },
        {
          "target": "json",
          "resolved": false,
          "confidence": 0,
          "line": 223
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_admin_endpoint_requires_admin_role:226",
      "name": "test_admin_endpoint_requires_admin_role",
      "startLine": 226,
      "endLine": 257,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "FastAPI",
          "resolved": false,
          "confidence": 0,
          "line": 228
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 230
        },
        {
          "target": "TestClient",
          "resolved": false,
          "confidence": 0,
          "line": 234
        },
        {
          "target": "app",
          "resolved": true,
          "confidence": 0.95,
          "line": 234,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:app:26"
        },
        {
          "target": "create_token",
          "resolved": true,
          "confidence": 0.95,
          "line": 237,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:create_token:175"
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 242
        },
        {
          "target": "create_token",
          "resolved": true,
          "confidence": 0.95,
          "line": 248,
          "resolvedId": "autogpt_libs/auth/dependencies_test.py:create_token:175"
        },
        {
          "target": "get",
          "resolved": false,
          "confidence": 0,
          "line": 253
        },
        {
          "target": "json",
          "resolved": false,
          "confidence": 0,
          "line": 257
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_dependency_with_complex_payload:264",
      "name": "test_dependency_with_complex_payload",
      "startLine": 264,
      "endLine": 285,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 280,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "complex_payload",
          "resolved": false,
          "confidence": 0,
          "line": 280
        },
        {
          "target": "requires_admin_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 284,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_admin_user:65"
        },
        {
          "target": "complex_payload",
          "resolved": false,
          "confidence": 0,
          "line": 284
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_dependency_with_unicode_in_payload:288",
      "name": "test_dependency_with_unicode_in_payload",
      "startLine": 288,
      "endLine": 299,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 297,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "unicode_payload",
          "resolved": false,
          "confidence": 0,
          "line": 297
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_dependency_with_null_values:302",
      "name": "test_dependency_with_null_values",
      "startLine": 302,
      "endLine": 314,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 312,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "null_payload",
          "resolved": false,
          "confidence": 0,
          "line": 312
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_concurrent_requests_isolation:317",
      "name": "test_concurrent_requests_isolation",
      "startLine": 317,
      "endLine": 329,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "requires_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 323,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_user:55"
        },
        {
          "target": "payload1",
          "resolved": false,
          "confidence": 0,
          "line": 323
        },
        {
          "target": "requires_admin_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 324,
          "resolvedId": "autogpt_libs/auth/dependencies.py:requires_admin_user:65"
        },
        {
          "target": "payload2",
          "resolved": false,
          "confidence": 0,
          "line": 324
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_dependency_error_cases:342",
      "name": "test_dependency_error_cases",
      "startLine": 342,
      "endLine": 351,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 349
        },
        {
          "target": "verify_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 350,
          "resolvedId": "autogpt_libs/auth/jwt_utils.py:verify_user:68"
        },
        {
          "target": "payload",
          "resolved": false,
          "confidence": 0,
          "line": 350
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_dependency_valid_user:354",
      "name": "test_dependency_valid_user",
      "startLine": 354,
      "endLine": 361,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "verify_user",
          "resolved": true,
          "confidence": 0.8,
          "line": 360,
          "resolvedId": "autogpt_libs/auth/jwt_utils.py:verify_user:68"
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_admin_impersonation_success:368",
      "name": "test_admin_impersonation_success",
      "startLine": 368,
      "endLine": 401,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 370
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 379
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 380
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 385
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 387
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 391,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 391
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 391
        },
        {
          "target": "assert_called_once",
          "resolved": false,
          "confidence": 0,
          "line": 397
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_non_admin_impersonation_attempt:404",
      "name": "test_non_admin_impersonation_attempt",
      "startLine": 404,
      "endLine": 428,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 406
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 415
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 416
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 420
        },
        {
          "target": "raises",
          "resolved": false,
          "confidence": 0,
          "line": 424
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 425,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 425
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 425
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_impersonation_empty_header:431",
      "name": "test_impersonation_empty_header",
      "startLine": 431,
      "endLine": 448,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 433
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 441
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 445,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 445
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 445
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_impersonation_missing_header:451",
      "name": "test_impersonation_missing_header",
      "startLine": 451,
      "endLine": 468,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 453
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 461
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 465,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 465
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 465
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_impersonation_audit_logging_details:471",
      "name": "test_impersonation_audit_logging_details",
      "startLine": 471,
      "endLine": 503,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 473
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 482
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 483
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 488
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 490
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 494,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 494
        },
        {
          "target": "assert_called_once",
          "resolved": false,
          "confidence": 0,
          "line": 498
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_impersonation_header_case_sensitivity:506",
      "name": "test_impersonation_header_case_sensitivity",
      "startLine": 506,
      "endLine": 524,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 508
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 517
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 521,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 521
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 521
        }
      ],
      "calledBy": [],
      "dataAccess": []
    },
    {
      "id": "autogpt_libs/auth/dependencies_test.py:test_impersonation_with_whitespace_header:527",
      "name": "test_impersonation_with_whitespace_header",
      "startLine": 527,
      "endLine": 554,
      "isEntryPoint": true,
      "isDataAccessor": false,
      "calls": [
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 529
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 538
        },
        {
          "target": "Mock",
          "resolved": false,
          "confidence": 0,
          "line": 539
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 544
        },
        {
          "target": "patch",
          "resolved": false,
          "confidence": 0,
          "line": 546
        },
        {
          "target": "get_user_id",
          "resolved": true,
          "confidence": 0.8,
          "line": 550,
          "resolvedId": "autogpt_libs/auth/dependencies.py:get_user_id:77"
        },
        {
          "target": "request",
          "resolved": false,
          "confidence": 0,
          "line": 550
        },
        {
          "target": "jwt_payload",
          "resolved": false,
          "confidence": 0,
          "line": 550
        },
        {
          "target": "assert_called_once",
          "resolved": false,
          "confidence": 0,
          "line": 554
        }
      ],
      "calledBy": [],
      "dataAccess": []
    }
  ]
}